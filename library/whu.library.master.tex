\WHUDependency 
  {
    package = { tabularray },
    library = { util, constant, information }
  }
\WHUProvideExplLibrary{master}{\whu@date}{\whu@version}{setting for normal master thesis of Wuhan University}


% 硕士学位类型：academic, professional
\msg_new:nnn { whu } { invalid-degree-type }
  {
    Invalid~degree~type~`#1'. \\ Please~type~`academic'~or~`professional'. 
  }
\str_new:N \g__whu_master_degree_type_str
\keys_define:nn { whu/master }
  {
    degree-type .choice:,
    degree-type / academic .code:n = { \str_gset:Nn \g__whu_master_degree_type_str { academic } },
    degree-type / professional .code:n = { \str_gset:Nn \g__whu_master_degree_type_str { professional } },
    degree-type .initial:n = academic,
    degree-type / unknown .code:n = { \msg_error:nnn { whu } { invalid-degree-type } {#1} },
  }





% ------------ %
% constant 设置 %
% ------------ %
\AtEndPreamble
  {
    \str_case:Vn \g__whu_master_degree_type_str
      {
        { academic } { \__whu_academic_master_constant_set: }
        { professional } { \__whu_professional_master_constant_set: }
      }
  }
\cs_new:Nn \__whu_academic_master_constant_set: 
  {
    \__whu_academic_master_constant_initial_set:
    \__whu_academic_master_constant_additional_set:
  }
\cs_new:Nn \__whu_academic_master_constant_additional_set: { }
\cs_new:Nn \__whu_academic_master_constant_initial_set:
  {
    \cs_set:Nn \__whu_cover_zh_thesis_type_format: { \zihao { 2 } \ziju{1} }
    \__whu_set_information_family:n
      {
        thesis-type/zh = 硕士学位论文,
        title =
          {
            zh = 武汉大学硕士学位论文 \LaTeX{} 模板,
            en = \LaTeX{} Template~for~Professional~Master's~Degree~of~Wuhan~University
          },
        department =
          {
            zh = 学院,
            en = School
          },
        author =
          {
            zh = 研究生姓名,
            en = Candidate
          },
        student-id =
          {
            zh = 学号,
            en = Student~Number
          },
        supervisor =
          {
            zh = 指导教师姓名、职称,
            en = Supervisor
          },
        major =
          {
            zh = 专业名称,
            en = Major
          },
        professional-field =
          {
            zh = 研究方向,
            en = Speciality
          },
      }
    \__whu_set_information_constant_family:n
      {
        clc/zh          = 分类号,
        secret-level/zh = 密级,
        udc/zh          = UDC,
        school-id/zh    = 编号,
        author =
          {
            zh = 研究生姓名,
            en = Candidate
          },
        student-id =
          {
            zh = 学号,
            en = Student~Number
          },
        supervisor =
          {
            zh = 指导教师姓名、职称,
            en = Supervisor
          },
        major =
          {
            zh = 专业名称,
            en = Major
          },
        professional-field =
          {
            zh = 研究方向,
            en = Speciality
          },
      }
    \cs_set:Nn \__whu_cover_zh_information_content: 
      {
        \begin{minipage} [ c ] { 0.72\textwidth }
          \clist_set:Nx \l__whu_tmpa_clist
            {
              \__whu_use_information_constant:nn { author } { zh } ,
              \__whu_use_information_constant:nn { student-id } { zh } ,
              \__whu_use_information_constant:nn { supervisor } { zh } ,
              \__whu_use_information_constant:nn { major } { zh } ,
              \__whu_use_information_constant:nn { professional-field } { zh }
            }
          \clist_set:Nx \l__whu_tmpb_clist
            {
              \__whu_use_information:nn { author } { zh },
              \__whu_use_information:nn { student-id } { zh },
              \__whu_use_information:nn { supervisor } { zh },
              \__whu_use_information:nn { major } { zh },
              \__whu_use_information:nn { professional-field } { zh }
            }
          \bool_until_do:nn
            { \clist_if_empty_p:N \l__whu_tmpa_clist }
            {
              \clist_pop:NN \l__whu_tmpa_clist \l__whu_tmpa_tl
              \clist_pop:NN \l__whu_tmpb_clist \l__whu_tmpb_tl
              \__whu_spread_box:nn { 4.45cm } { \l__whu_tmpa_tl } :
              \hspace{1.3em}
              \l__whu_tmpb_tl
              \skip_vertical:n { 3ex }
            }
        \end{minipage}
      }
    \cs_set:Nn \__whu_cover_en_information_content: 
      {
        \begin{tblr}
          {
            cell{1, 3}{2} = { cmd = \textsc },
            % hlines, vlines,
            colspec = { X[1,r] X[1,l] },
            rowsep = 1.5pt
          }
          \__whu_use_information_constant:nn { author } { en } : & \__whu_use_information:nn { author } { en } \\
          \__whu_use_information_constant:nn { student-id } { en } : & \__whu_use_information:nn { student-id } { en } \\
          \__whu_use_information_constant:nn { supervisor } { en } : & \__whu_use_information:nn { supervisor } { en } \\
          \__whu_use_information_constant:nn { major } { en } : & \__whu_use_information:nn { major } { en } \\
          \__whu_use_information_constant:nn { professional-field } { en } : & \__whu_use_information:nn { professional-field } { en }
        \end{tblr}
      }
  }
\cs_new:Nn \__whu_professional_master_constant_set: 
  {
    \__whu_professional_master_constant_initial_set:
    \__whu_professional_master_constant_additional_set:
  }
\cs_new:Nn \__whu_professional_master_constant_additional_set: { }
\cs_new:Nn \__whu_professional_master_constant_initial_set:
  {
    \cs_set:Nn \__whu_cover_zh_thesis_type_format: { \zihao { 2 } \ziju{0.5} }
    \__whu_set_information_family:n
      {
        thesis-type/zh = 硕士专业学位论文,
        title =
          {
            zh = 武汉大学硕士专业学位论文 \LaTeX{} 模板,
            en = \LaTeX{} Template~for~Professional~Master's~Degree~of~Wuhan~University
          },
        department =
          {
            zh = 数学与统计学院,
            en = School~of~Mathematics~and~Statistics
          },
        author =
          {
            zh = 研究生姓名,
            en = Candidate
          },
        student-id =
          {
            zh = 学号,
            en = Student~Number
          },
        supervisor =
          {
            zh = 指导教师姓名、职称,
            en = Supervisor
          },
        major =
          {
            zh = 专业名称,
            en = Major
          },
      }
    \__whu_set_information_constant_family:n
      {
        clc/zh          = 分类号,
        secret-level/zh = 密级,
        udc/zh          = UDC,
        school-id/zh    = 编号,
        author =
          {
            zh = 研究生姓名,
            en = Candidate
          },
        student-id =
          {
            zh = 学号,
            en = Student~Number
          },
        supervisor =
          {
            zh = 指导教师姓名、职称,
            en = Supervisor
          },
        major =
          {
            zh = 专业类别（领域）,
            en = Major
          },
      }
    \cs_set:Nn \__whu_cover_zh_information_content: 
      {
        \begin{minipage} [ c ] { 0.72\textwidth }
          \clist_set:Nx \l__whu_tmpa_clist
            {
              \__whu_use_information_constant:nn { author } { zh } ,
              \__whu_use_information_constant:nn { student-id } { zh } ,
              \__whu_use_information_constant:nn { supervisor } { zh } ,
              \__whu_use_information_constant:nn { major } { zh } ,
            }
          \clist_set:Nx \l__whu_tmpb_clist
            {
              \__whu_use_information:nn { author } { zh },
              \__whu_use_information:nn { student-id } { zh },
              \__whu_use_information:nn { supervisor } { zh },
              \__whu_use_information:nn { major } { zh },
            }
          \bool_until_do:nn
            { \clist_if_empty_p:N \l__whu_tmpa_clist }
            {
              \clist_pop:NN \l__whu_tmpa_clist \l__whu_tmpa_tl
              \clist_pop:NN \l__whu_tmpb_clist \l__whu_tmpb_tl
              \__whu_spread_box:nn { 4.45cm } { \l__whu_tmpa_tl } :
              \hspace{1.3em}
              \l__whu_tmpb_tl
              \skip_vertical:n { 3ex }
            }
        \end{minipage}
      }
    \cs_set:Nn \__whu_cover_en_information_content: 
      {
        \begin{tblr}
          {
            cell{1, 3}{2} = { cmd = \textsc },
            % hlines, vlines,
            colspec = { X[1,r] X[1,l] },
            rowsep = 1.5pt
          }
          \__whu_use_information_constant:nn { author } { en } : & \__whu_use_information:nn { author } { en } \\
          \__whu_use_information_constant:nn { student-id } { en } : & \__whu_use_information:nn { student-id } { en } \\
          \__whu_use_information_constant:nn { supervisor } { en } : & \__whu_use_information:nn { supervisor } { en } \\
          \__whu_use_information_constant:nn { major } { en } : & \__whu_use_information:nn { major } { en } \\
        \end{tblr}
      }
  }



\ProcessKeyOptions [ whu/master ]